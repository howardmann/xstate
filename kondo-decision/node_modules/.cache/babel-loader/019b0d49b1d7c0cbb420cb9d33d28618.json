{"ast":null,"code":"import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };","map":{"version":3,"sources":["/Users/howardmann/Howie/practice/xstate/kondo-decision/node_modules/xstate/es/scheduler.js"],"names":["__assign","defaultOptions","deferEvents","Scheduler","options","processingEvent","queue","initialized","prototype","initialize","callback","schedule","process","flushEvents","task","push","length","Error","clear","nextCallback","shift","e"],"mappings":"AAAA,SAASA,QAAT,QAAyB,sBAAzB;AACA,IAAIC,cAAc,GAAG;AACnBC,EAAAA,WAAW,EAAE;AADM,CAArB;;AAIA,IAAIC,SAAS;AACb;;AAEA;AACA,YAAY;AACV,WAASA,SAAT,CAAmBC,OAAnB,EAA4B;AAC1B,SAAKC,eAAL,GAAuB,KAAvB;AACA,SAAKC,KAAL,GAAa,EAAb;AACA,SAAKC,WAAL,GAAmB,KAAnB;AACA,SAAKH,OAAL,GAAeJ,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKC,cAAL,CAAT,EAA+BG,OAA/B,CAAvB;AACD;;AAEDD,EAAAA,SAAS,CAACK,SAAV,CAAoBC,UAApB,GAAiC,UAAUC,QAAV,EAAoB;AACnD,SAAKH,WAAL,GAAmB,IAAnB;;AAEA,QAAIG,QAAJ,EAAc;AACZ,UAAI,CAAC,KAAKN,OAAL,CAAaF,WAAlB,EAA+B;AAC7B,aAAKS,QAAL,CAAcD,QAAd;AACA;AACD;;AAED,WAAKE,OAAL,CAAaF,QAAb;AACD;;AAED,SAAKG,WAAL;AACD,GAbD;;AAeAV,EAAAA,SAAS,CAACK,SAAV,CAAoBG,QAApB,GAA+B,UAAUG,IAAV,EAAgB;AAC7C,QAAI,CAAC,KAAKP,WAAN,IAAqB,KAAKF,eAA9B,EAA+C;AAC7C,WAAKC,KAAL,CAAWS,IAAX,CAAgBD,IAAhB;AACA;AACD;;AAED,QAAI,KAAKR,KAAL,CAAWU,MAAX,KAAsB,CAA1B,EAA6B;AAC3B,YAAM,IAAIC,KAAJ,CAAU,8DAAV,CAAN;AACD;;AAED,SAAKL,OAAL,CAAaE,IAAb;AACA,SAAKD,WAAL;AACD,GAZD;;AAcAV,EAAAA,SAAS,CAACK,SAAV,CAAoBU,KAApB,GAA4B,YAAY;AACtC,SAAKZ,KAAL,GAAa,EAAb;AACD,GAFD;;AAIAH,EAAAA,SAAS,CAACK,SAAV,CAAoBK,WAApB,GAAkC,YAAY;AAC5C,QAAIM,YAAY,GAAG,KAAKb,KAAL,CAAWc,KAAX,EAAnB;;AAEA,WAAOD,YAAP,EAAqB;AACnB,WAAKP,OAAL,CAAaO,YAAb;AACAA,MAAAA,YAAY,GAAG,KAAKb,KAAL,CAAWc,KAAX,EAAf;AACD;AACF,GAPD;;AASAjB,EAAAA,SAAS,CAACK,SAAV,CAAoBI,OAApB,GAA8B,UAAUF,QAAV,EAAoB;AAChD,SAAKL,eAAL,GAAuB,IAAvB;;AAEA,QAAI;AACFK,MAAAA,QAAQ;AACT,KAFD,CAEE,OAAOW,CAAP,EAAU;AACV;AACA;AACA,WAAKH,KAAL;AACA,YAAMG,CAAN;AACD,KAPD,SAOU;AACR,WAAKhB,eAAL,GAAuB,KAAvB;AACD;AACF,GAbD;;AAeA,SAAOF,SAAP;AACD,CAlED,EAJA;;AAwEA,SAASA,SAAT","sourcesContent":["import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };"]},"metadata":{},"sourceType":"module"}